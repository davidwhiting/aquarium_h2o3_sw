"Kernel error: invalid configuration argument" usually means the arguments passed to <<< >>> are incorrect - remember what we said about the maximum number of threads per block?